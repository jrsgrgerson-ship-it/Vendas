<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CANIL MY BABY - DASHBOARD ELITE</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --blue: #00f2ff; --green: #00ff88; --red: #ff0055; 
            --bg: #050505; --card: #0f0f0f; --border: #1e1e1e; 
        }
        body { background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; margin: 0; padding: 15px; -webkit-font-smoothing: antialiased; }
        .container { max-width: 480px; margin: auto; }
        
        header { border-left: 5px solid var(--blue); padding-left: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        header h1 { margin: 0; font-size: 20px; font-weight: 900; letter-spacing: -1px; }

        /* PAINEL DE CONTAGEM */
        .count-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 15px; }
        .c-box { background: var(--card); padding: 10px 5px; border-radius: 12px; border: 1px solid var(--border); text-align: center; }
        .c-box b { display: block; font-size: 16px; color: var(--blue); }
        .c-box span { font-size: 8px; color: #666; font-weight: 800; text-transform: uppercase; }

        /* CARD PRINCIPAL E GR√ÅFICO */
        .main-card { background: var(--card); border-radius: 20px; padding: 20px; border: 1px solid var(--border); margin-bottom: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .chart-container { position: relative; height: 180px; width: 100%; margin-top: 20px; }
        
        /* FINANCEIRO */
        .fin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .fin-box { background: var(--card); padding: 15px; border-radius: 15px; border: 1px solid var(--border); }
        .fin-box span { font-size: 9px; color: #666; font-weight: 800; display: block; margin-bottom: 5px; }
        .fin-box b { font-size: 18px; display: block; }
        .liq { color: var(--green); border-bottom: 2px solid var(--green); padding-bottom: 5px; }
        .desc { color: var(--red); }

        /* INPUTS */
        .inputs { background: var(--card); padding: 15px; border-radius: 20px; border: 1px solid var(--border); margin-bottom: 20px; }
        input, select { background: #000; border: 1px solid #222; color: #fff; padding: 12px; border-radius: 10px; width: 100%; margin-bottom: 8px; box-sizing: border-box; font-size: 14px; }
        .btn-row { display: grid; grid-template-columns: 2fr 1fr; gap: 8px; }
        .btn-add { background: #fff; color: #000; border: none; padding: 15px; border-radius: 10px; font-weight: 900; cursor: pointer; }
        .btn-vale { background: var(--red); color: #fff; border: none; border-radius: 10px; font-weight: 900; cursor: pointer; }

        /* LISTA */
        .item { background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 8px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .item.entregue { border-left: 5px solid var(--green); background: linear-gradient(90deg, rgba(0,255,136,0.03), transparent); }
        .item b { font-size: 13px; text-transform: uppercase; }
        .item small { color: #555; font-size: 10px; }
        .btn-check { width: 38px; height: 38px; border-radius: 10px; border: 1px solid #333; background: #111; color: #444; cursor: pointer; transition: 0.2s; }
        .btn-check.on { background: var(--green); color: #000; border-color: var(--green); box-shadow: 0 0 15px var(--green); }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div><h1>CANIL MY BABY</h1><small style="color:var(--blue); font-weight:800; font-size:9px;">SISTEMA GERSON V7</small></div>
        <div style="text-align:right"><b id="totalTopo" style="font-size:18px; color:var(--blue);">R$ 0</b></div>
    </header>

    <div class="count-grid">
        <div class="c-box"><b id="cntS">0</b><span>üê∂ Spitz</span></div>
        <div class="c-box"><b id="cntB">0</b><span>üê± Bengal</span></div>
        <div class="c-box"><b id="cntM">0</b><span>‚ôÇ Macho</span></div>
        <div class="c-box"><b id="cntF">0</b><span>‚ôÄ F√™mea</span></div>
    </div>

    <div class="fin-grid">
        <div class="fin-box">
            <span>üî¥ DESCONTOS/VALES</span>
            <b id="totDescontos" class="desc">R$ 0</b>
        </div>
        <div class="fin-box">
            <span>üü¢ SAL√ÅRIO L√çQUIDO</span>
            <b id="salLiq" class="liq">R$ 0</b>
        </div>
    </div>

    <div class="main-card">
        <span style="font-size:10px; color:#555; font-weight:800;">DESEMPENHO DE VENDAS (R$)</span>
        <div class="chart-container">
            <canvas id="graficoEsplendido"></canvas>
        </div>
    </div>

    <div class="inputs">
        <div style="display:flex; gap:5px;">
            <select id="tipo"><option value="Spitz">Spitz üê∂</option><option value="Bengal">Bengal üê±</option></select>
            <select id="sexo"><option value="Macho">Macho ‚ôÇ</option><option value="F√™mea">F√™mea ‚ôÄ</option></select>
        </div>
        <input type="text" id="cliente" placeholder="Nome do Cliente">
        <input type="number" id="valor" placeholder="Valor da Venda R$">
        <div class="btn-row">
            <button class="btn-add" onclick="addVenda()">REGISTRAR VENDA</button>
            <button class="btn-vale" onclick="addVale()">- VALE</button>
        </div>
    </div>

    <div id="lista"></div>
    <button onclick="superResgate()" style="width:100%; background:none; border:none; color:#222; font-size:10px; padding:20px;">FOR√áAR SINCRONIZA√á√ÉO (74K)</button>
</div>

<script>
    let chart = null;
    let vendas = JSON.parse(localStorage.getItem('vendasV12')) || [];

    function salvar() {
        localStorage.setItem('vendasV12', JSON.stringify(vendas));
        render();
    }

    function addVenda() {
        const c = document.getElementById('cliente').value;
        const v = parseFloat(document.getElementById('valor').value);
        if (c && v) {
            vendas.push({
                id: Date.now() + Math.random(),
                cliente: c, valor: v,
                tipo: document.getElementById('tipo').value,
                sexo: document.getElementById('sexo').value,
                data: new Date().toLocaleDateString('pt-BR').substring(0, 5),
                entregue: false, isVale: false, ts: Date.now()
            });
            document.getElementById('cliente').value = '';
            document.getElementById('valor').value = '';
            salvar();
        }
    }

    function addVale() {
        const val = prompt("Valor do Vale/Adiantamento:");
        if (val) {
            vendas.push({
                id: Date.now(),
                cliente: 'VALE / ADIANTAMENTO', valor: parseFloat(val),
                data: new Date().toLocaleDateString('pt-BR').substring(0, 5),
                isVale: true, ts: Date.now()
            });
            salvar();
        }
    }

    function toggle(id) {
        const v = vendas.find(x => x.id === id);
        if (v) { v.entregue = !v.entregue; salvar(); }
    }

    function del(id) { if(confirm("Remover?")) { vendas = vendas.filter(x => x.id !== id); salvar(); } }

    function superResgate() {
        const keys = ['vendasV12', 'vendasV5', 'vendas_backup_seguro'];
        keys.forEach(k => {
            let d = localStorage.getItem(k);
            if(d) {
                let l = JSON.parse(d);
                if(l.length > vendas.length) { vendas = l; salvar(); }
            }
        });
    }

    function render() {
        const div = document.getElementById('lista');
        div.innerHTML = '';
        let totalBruto = 0, descontos = 0, s=0, b=0, m=0, f=0;
        let hist = {};

        [...vendas].sort((a,b) => b.ts - a.ts).forEach(v => {
            if (v.isVale) {
                descontos += v.valor;
                div.innerHTML += `<div class="item" style="border-color:var(--red); opacity:0.8;">
                    <div><b>${v.cliente}</b><small>${v.data}</small></div>
                    <div style="color:var(--red); font-weight:900;">- R$ ${v.valor.toLocaleString()}</div>
                    <button class="btn-check" onclick="del(${v.id})">üóë</button>
                </div>`;
            } else {
                totalBruto += v.valor;
                if(v.tipo === 'Spitz') s++; else b++;
                if(v.sexo === 'Macho' || v.sexo === '‚ôÇ') m++; else f++;
                
                hist[v.data] = (hist[v.data] || 0) + v.valor;

                div.innerHTML += `
                    <div class="item ${v.entregue ? 'entregue' : ''}">
                        <div><b>${v.cliente}</b><small>${v.tipo} ${v.sexo} | ${v.data}</small></div>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <b style="color:${v.entregue?'var(--green)':'#fff'}">R$ ${v.valor.toLocaleString()}</b>
                            <button class="btn-check ${v.entregue ? 'on' : ''}" onclick="toggle(${v.id})">‚úî</button>
                        </div>
                    </div>`;
            }
        });

        // Dashboard Financeiro
        document.getElementById('totalTopo').innerText = "R$ " + totalBruto.toLocaleString();
        document.getElementById('totDescontos').innerText = "R$ " + descontos.toLocaleString();
        let liq = (totalBruto * 0.03) + 2000 - descontos;
        document.getElementById('salLiq').innerText = "R$ " + liq.toLocaleString('pt-BR', {minimumFractionDigits:2});

        // Contadores
        document.getElementById('cntS').innerText = s; document.getElementById('cntB').innerText = b;
        document.getElementById('cntM').innerText = m; document.getElementById('cntF').innerText = f;

        // Gr√°fico Splendid
        const ctx = document.getElementById('graficoEsplendido').getContext('2d');
        if (chart) chart.destroy();
        
        const labels = Object.keys(hist).slice(-7);
        const dataVendas = labels.map(l => hist[l]);

        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Vendas',
                    data: dataVendas,
                    borderColor: '#00f2ff',
                    borderWidth: 3,
                    pointBackgroundColor: '#00f2ff',
                    pointRadius: 4,
                    fill: true,
                    backgroundColor: (context) => {
                        const g = context.chart.ctx.createLinearGradient(0, 0, 0, 200);
                        g.addColorStop(0, 'rgba(0, 242, 255, 0.2)');
                        g.addColorStop(1, 'transparent');
                        return g;
                    },
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#1a1a1a' },
                        ticks: {
                            color: '#444',
                            font: { size: 9 },
                            stepSize: 2000,
                            callback: (v) => v >= 1000 ? (v/1000) + 'k' : v
                        }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#666', font: { size: 10 } }
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    }

    superResgate();
    render();
</script>
</body>
</html>
