<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON PRIME | Vendas & Comiss√µes</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            /* Paleta Neon */
            --bg-dark: #050505;
            --bg-panel: #101014;
            --primary: #00f3ff; /* Ciano Neon */
            --secondary: #bc13fe; /* Roxo Neon */
            --success: #00ff9d; /* Verde Matrix */
            --danger: #ff0055; /* Vermelho Laser */
            --warning: #ffce00; /* Amarelo */
            --glass: rgba(20, 20, 30, 0.7);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background-color: var(--bg-dark); 
            background-image: radial-gradient(circle at 50% 0%, #1a1a2e 0%, #050505 80%);
            color: #fff; 
            font-family: 'Inter', sans-serif; 
            padding: 20px;
            min-height: 100vh;
        }

        .container { max-width: 1250px; margin: 0 auto; padding-bottom: 50px; }

        /* --- HEADER FUTURISTA --- */
        header {
            display: flex; justify-content: space-between; align-items: flex-end;
            padding: 30px 0; border-bottom: 1px solid var(--border); margin-bottom: 30px;
        }
        h1 { 
            font-family: 'Orbitron', sans-serif; font-size: 32px; 
            text-transform: uppercase; letter-spacing: 2px;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
        }
        h1 span { color: var(--primary); }

        /* Bot√µes de A√ß√£o */
        .toolbar { display: flex; gap: 15px; }
        .btn-tool {
            background: rgba(255,255,255,0.05); border: 1px solid var(--border);
            color: #ccc; padding: 10px 15px; border-radius: 8px; font-family: 'Rajdhani', sans-serif;
            font-weight: 700; cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 8px;
        }
        .btn-tool:hover { background: rgba(255,255,255,0.1); color: #fff; border-color: #fff; box-shadow: 0 0 15px rgba(255,255,255,0.1); }
        
        .btn-pdf { background: var(--primary); color: #000; border: none; }
        .btn-pdf:hover { background: #fff; color: #000; box-shadow: 0 0 20px var(--primary); }

        /* --- DASHBOARD CARDS (GLASSMORPHISM) --- */
        .grid-stats {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px; margin-bottom: 30px;
        }
        .card {
            background: var(--glass); backdrop-filter: blur(10px);
            border: 1px solid var(--border); border-radius: 16px; padding: 25px;
            position: relative; overflow: hidden; transition: transform 0.3s;
        }
        .card:hover { transform: translateY(-5px); border-color: rgba(255,255,255,0.2); }
        
        .card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
        }
        .card-vendas::before { background: var(--primary); box-shadow: 0 0 10px var(--primary); }
        .card-vales::before { background: var(--danger); box-shadow: 0 0 10px var(--danger); }
        .card-liquido { background: linear-gradient(135deg, rgba(0,255,157,0.05), rgba(0,0,0,0)); border: 1px solid rgba(0,255,157,0.3); }
        .card-liquido::before { background: var(--success); box-shadow: 0 0 15px var(--success); }

        .card h3 { font-family: 'Rajdhani', sans-serif; color: #888; font-size: 14px; text-transform: uppercase; margin-bottom: 5px; letter-spacing: 1px; }
        .card .value { font-family: 'Orbitron', sans-serif; font-size: 28px; margin-bottom: 5px; display: block; }
        .card .sub { font-size: 12px; opacity: 0.6; }

        .glow-text-blue { color: var(--primary); text-shadow: 0 0 10px rgba(0, 243, 255, 0.4); }
        .glow-text-red { color: var(--danger); text-shadow: 0 0 10px rgba(255, 0, 85, 0.4); }
        .glow-text-green { color: var(--success); text-shadow: 0 0 15px rgba(0, 255, 157, 0.4); }

        /* --- GR√ÅFICO --- */
        .chart-container {
            background: var(--glass); border: 1px solid var(--border);
            border-radius: 16px; padding: 20px; margin-bottom: 30px; height: 350px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        /* --- INPUTS --- */
        .input-panel {
            background: #15151a; padding: 25px; border-radius: 16px; 
            border: 1px solid var(--border); margin-bottom: 30px;
            display: flex; gap: 15px; flex-wrap: wrap; align-items: center;
        }
        input, select {
            background: #0a0a0e; border: 1px solid #333; color: #fff;
            padding: 15px; border-radius: 8px; font-family: 'Rajdhani', sans-serif;
            font-size: 16px; font-weight: 600; outline: none; transition: 0.3s;
        }
        input:focus, select:focus { border-color: var(--primary); box-shadow: 0 0 10px rgba(0,243,255,0.2); }

        .btn-add {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: #fff; border: none; padding: 15px 30px; border-radius: 8px;
            font-family: 'Orbitron', sans-serif; cursor: pointer; flex-grow: 1;
            text-transform: uppercase; font-size: 14px; letter-spacing: 1px;
            transition: 0.3s;
        }
        .btn-add:hover { filter: brightness(1.2); box-shadow: 0 0 20px rgba(188, 19, 254, 0.4); }

        .btn-vale-action {
            background: transparent; border: 1px solid var(--danger); color: var(--danger);
            padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold;
            font-family: 'Rajdhani', sans-serif; text-transform: uppercase;
        }
        .btn-vale-action:hover { background: var(--danger); color: #fff; box-shadow: 0 0 15px var(--danger); }

        /* --- TABELA --- */
        .table-wrap { overflow-x: auto; background: var(--bg-panel); border-radius: 16px; border: 1px solid var(--border); }
        table { width: 100%; border-collapse: collapse; }
        
        th { 
            text-align: left; padding: 20px; color: #888; font-size: 12px; 
            text-transform: uppercase; font-family: 'Orbitron', sans-serif; 
            border-bottom: 1px solid #222; 
        }
        td { padding: 20px; border-bottom: 1px solid #222; font-size: 14px; }
        
        /* Status Badges */
        .badge { padding: 5px 10px; border-radius: 4px; font-size: 10px; font-weight: bold; text-transform: uppercase; font-family: 'Orbitron', sans-serif; }
        .b-ok { background: rgba(0, 255, 157, 0.1); color: var(--success); border: 1px solid var(--success); }
        .b-cancel { background: rgba(255, 206, 0, 0.1); color: var(--warning); border: 1px solid var(--warning); }
        .b-vale { background: rgba(255, 0, 85, 0.1); color: var(--danger); border: 1px solid var(--danger); }

        /* A√ß√µes */
        .actions button {
            background: transparent; border: 1px solid #333; color: #666;
            width: 32px; height: 32px; border-radius: 6px; cursor: pointer; transition: 0.2s;
        }
        .actions button:hover { border-color: #fff; color: #fff; }

        /* Espec√≠fico para linhas de Vale e Cancelado */
        tr.row-vale td { color: var(--danger); }
        tr.row-cancel td { color: #888; text-decoration: none; } /* Removi strikethrough para legibilidade */
        tr.row-cancel .val-txt { text-decoration: line-through; opacity: 0.5; font-size: 12px; }
        tr.row-cancel .sinal-txt { color: var(--warning); font-weight: bold; display: block; }

        /* --- PRINT (PDF) --- */
        @media print {
            body { background: #fff !important; color: #000 !important; background-image: none !important; }
            .no-print, .input-panel, .toolbar, .actions, .chart-container { display: none !important; }
            .card { background: #fff !important; border: 1px solid #000 !important; box-shadow: none !important; color: #000 !important; }
            .card::before { display: none; }
            .glow-text-blue, .glow-text-red, .glow-text-green { color: #000 !important; text-shadow: none !important; }
            table { border: 1px solid #000; }
            th { border-bottom: 2px solid #000; color: #000; }
            td { border-bottom: 1px solid #ddd; color: #000 !important; }
            .print-header { display: block !important; margin-bottom: 30px; text-align: center; border: 2px solid #000; padding: 20px; }
            .badge { border: 1px solid #000; color: #000 !important; background: none !important; }
        }
        .print-header { display: none; }

        /* Stats Mini Icons */
        .stat-icon { font-size: 18px; margin-right: 5px; }
    </style>
</head>
<body>

<div class="container">
    
    <div class="print-header">
        <h2>RELAT√ìRIO DE COMISS√ïES</h2>
        <p>Vendedor: <b>Gerson</b> | Data: <span id="dataPrint"></span></p>
    </div>

    <header class="no-print">
        <div>
            <h1>NEON <span>PRIME</span></h1>
            <p style="color:#666; font-size:12px; margin-top:5px; font-family:'Rajdhani', sans-serif; letter-spacing:1px;">PAINEL DE VENDAS & COMISS√ïES v14</p>
        </div>
        <div class="toolbar">
            <input type="file" id="fileImport" style="display:none" onchange="importarDados(this)">
            <button class="btn-tool" onclick="document.getElementById('fileImport').click()">üìÇ IMPORTAR</button>
            <button class="btn-tool" onclick="exportarDados()">üíæ BACKUP</button>
            <button class="btn-tool btn-pdf" onclick="window.print()">üñ®Ô∏è PDF</button>
        </div>
    </header>

    <div class="grid-stats no-print" style="grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;">
        <div style="background:#111; padding:10px; border-radius:8px; text-align:center; border:1px solid #222;">
            <span style="color:#fff">üê∂ SPITZ:</span> <strong style="color:var(--primary)" id="cntSpitz">0</strong>
        </div>
        <div style="background:#111; padding:10px; border-radius:8px; text-align:center; border:1px solid #222;">
            <span style="color:#fff">üêØ BENGAL:</span> <strong style="color:var(--warning)" id="cntBengal">0</strong>
        </div>
        <div style="background:#111; padding:10px; border-radius:8px; text-align:center; border:1px solid #222;">
            <span style="color:#fff">üíô MACHOS:</span> <strong style="color:#3498db" id="cntM">0</strong>
        </div>
        <div style="background:#111; padding:10px; border-radius:8px; text-align:center; border:1px solid #222;">
            <span style="color:#fff">üíñ F√äMEAS:</span> <strong style="color:#e91e63" id="cntF">0</strong>
        </div>
    </div>

    <div class="grid-stats">
        <div class="card card-vendas">
            <h3>VENDAS + SINAIS</h3>
            <span class="value glow-text-blue" id="dispVendas">R$ 0,00</span>
            <span class="sub" id="dispQtd">0 Lan√ßamentos</span>
        </div>
        <div class="card card-bruto" style="border-left: 1px solid var(--border);">
            <h3>COMISS√ÉO BRUTA</h3>
            <span class="value" style="color: #fff;" id="dispComissaoBruta">R$ 0,00</span>
            <span class="sub">Sal√°rio (2k) + 3%</span>
        </div>
        <div class="card card-vales">
            <h3>(-) ADIANTAMENTOS</h3>
            <span class="value glow-text-red" id="dispVales">R$ 0,00</span>
            <span class="sub">Desconto em folha</span>
        </div>
        <div class="card card-liquido">
            <h3>üí∞ L√çQUIDO A RECEBER</h3>
            <span class="value glow-text-green" id="dispLiquido">R$ 0,00</span>
            <span class="sub">J√° descontando vales</span>
        </div>
    </div>

    <div class="chart-container no-print">
        <canvas id="neonChart"></canvas>
    </div>

    <div class="input-panel no-print">
        <div style="flex:1; min-width: 200px;">
            <select id="inRaca" style="width: 100%;">
                <option value="Spitz">Spitz Alem√£o</option>
                <option value="Bengal">Gato Bengal</option>
                <option value="Outros">Outros</option>
            </select>
        </div>
        <div style="width: 120px;">
            <select id="inSexo" style="width: 100%;">
                <option value="M">Macho</option>
                <option value="F">F√™mea</option>
            </select>
        </div>
        <div style="flex:2; min-width: 250px;">
            <input type="text" id="inCli" placeholder="Nome do Cliente" style="width: 100%;">
        </div>
        <div style="width: 150px;">
            <input type="number" id="inVal" placeholder="Valor R$" style="width: 100%;">
        </div>
        <button class="btn-add" onclick="addVenda()">üöÄ LAN√áAR</button>
        <button class="btn-vale-action" onclick="addVale()">üõë VALE</button>
    </div>

    <div class="table-wrap">
        <table>
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Status</th>
                    <th>Detalhes do Cliente</th>
                    <th>Valor Transa√ß√£o</th>
                    <th>Comiss√£o (3%)</th>
                    <th class="no-print" style="text-align:right">Op√ß√µes</th>
                </tr>
            </thead>
            <tbody id="listBody"></tbody>
        </table>
    </div>

</div>

<script>
    const DB_KEY = 'NEON_PRIME_DATA_V14';
    let system = { vendas: [] };
    let chartInstance = null;

    // --- CARREGAMENTO ---
    function init() {
        const d = localStorage.getItem(DB_KEY);
        if(d) system = JSON.parse(d);
        document.getElementById('dataPrint').innerText = new Date().toLocaleDateString();
        render();
    }

    function save() {
        localStorage.setItem(DB_KEY, JSON.stringify(system));
        render();
    }

    // --- IMPORT / EXPORT ---
    function exportarDados() {
        const json = JSON.stringify(system);
        const blob = new Blob([json], {type: "application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `Backup_Comissoes_${new Date().toLocaleDateString().replace(/\//g,'-')}.json`;
        a.click();
    }

    function importarDados(input) {
        const file = input.files[0];
        if(!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                system = JSON.parse(e.target.result);
                save();
                alert('Dados importados com sucesso! Bem-vindo de volta.');
            } catch(x) { alert('Erro no arquivo.'); }
        };
        reader.readAsText(file);
    }

    // --- LOGIC ---
    function addVenda() {
        const cli = document.getElementById('inCli').value;
        const val = parseFloat(document.getElementById('inVal').value);
        if(cli && val) {
            system.vendas.push({
                id: Date.now(),
                data: new Date().toLocaleDateString('pt-BR').substring(0,5),
                tipo: 'venda',
                cliente: cli,
                raca: document.getElementById('inRaca').value,
                sexo: document.getElementById('inSexo').value,
                valor: val,
                cancelada: false
            });
            document.getElementById('inCli').value = '';
            document.getElementById('inVal').value = '';
            save();
        }
    }

    function addVale() {
        const val = prompt("Valor do Vale/Retirada (R$):");
        if(val) {
            system.vendas.push({
                id: Date.now(),
                data: new Date().toLocaleDateString('pt-BR').substring(0,5),
                tipo: 'vale',
                cliente: 'ADIANTAMENTO',
                valor: parseFloat(val)
            });
            save();
        }
    }

    function toggleStatus(id) {
        const i = system.vendas.findIndex(x => x.id === id);
        if(i >= 0) {
            system.vendas[i].cancelada = !system.vendas[i].cancelada;
            save();
        }
    }

    function remove(id) {
        if(confirm("Deletar registro?")) {
            system.vendas = system.vendas.filter(x => x.id !== id);
            save();
        }
    }

    // --- RENDER ---
    function render() {
        const tbody = document.getElementById('listBody');
        tbody.innerHTML = '';

        // Contadores
        let totalVendas = 0;
        let totalVales = 0;
        let comissaoVar = 0;
        let stats = { spitz:0, bengal:0, m:0, f:0 };

        // Arrays grafico
        let chartLabels = [];
        let chartData = [];

        // Ordena√ß√£o Cronol√≥gica para c√°lculo e gr√°fico
        const cronologico = [...system.vendas].sort((a,b) => a.id - b.id);

        cronologico.forEach(v => {
            if(v.tipo === 'vale') {
                totalVales += v.valor;
            } else {
                // REGRA: Venda ou Cancelada (Sinal) somam
                totalVendas += v.valor;
                comissaoVar += (v.valor * 0.03);
                
                // Stats
                if(v.raca === 'Spitz') stats.spitz++;
                if(v.raca === 'Bengal') stats.bengal++;
                if(v.sexo === 'M') stats.m++;
                if(v.sexo === 'F') stats.f++;

                chartLabels.push(v.data);
                chartData.push(v.valor);
            }
        });

        const brutoGerson = 2000 + comissaoVar;
        const liquido = brutoGerson - totalVales;

        // Atualizar Dashboard
        document.getElementById('dispVendas').innerText = `R$ ${totalVendas.toLocaleString('pt-BR')}`;
        document.getElementById('dispQtd').innerText = `${cronologico.filter(x=>x.tipo!='vale').length} Vendas`;
        document.getElementById('dispComissaoBruta').innerText = `R$ ${brutoGerson.toLocaleString('pt-BR', {minimumFractionDigits:2})}`;
        document.getElementById('dispVales').innerText = `R$ ${totalVales.toLocaleString('pt-BR')}`;
        document.getElementById('dispLiquido').innerText = `R$ ${liquido.toLocaleString('pt-BR', {minimumFractionDigits:2})}`;
        
        // Atualizar Stats
        document.getElementById('cntSpitz').innerText = stats.spitz;
        document.getElementById('cntBengal').innerText = stats.bengal;
        document.getElementById('cntM').innerText = stats.m;
        document.getElementById('cntF').innerText = stats.f;

        // Tabela (Inversa)
        [...cronologico].reverse().forEach(v => {
            if(v.tipo === 'vale') {
                tbody.innerHTML += `
                    <tr class="row-vale">
                        <td>${v.data}</td>
                        <td><span class="badge b-vale">VALE</span></td>
                        <td><b>ADIANTAMENTO DE SAL√ÅRIO</b></td>
                        <td>- R$ ${v.valor.toLocaleString()}</td>
                        <td>-</td>
                        <td class="actions no-print" style="text-align:right">
                            <button onclick="remove(${v.id})">üóë</button>
                        </td>
                    </tr>`;
            } else {
                const isCancel = v.cancelada;
                const badge = isCancel 
                    ? `<span class="badge b-cancel">SINAL / CANCELADO</span>` 
                    : `<span class="badge b-ok">ENTREGUE</span>`;
                
                const valDisplay = isCancel 
                    ? `<span class="val-txt">R$ ${v.valor.toLocaleString()}</span> <span class="sinal-txt">SINAL PAGO (Contabilizado)</span>`
                    : `R$ ${v.valor.toLocaleString()}`;

                tbody.innerHTML += `
                    <tr class="${isCancel ? 'row-c
